{"metadata":{"roleHeading":"Article","role":"article","modules":[{"name":"ScribbleLab"}],"title":"Auth"},"identifier":{"url":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/Auth","interfaceLanguage":"swift"},"seeAlsoSections":[{"generated":true,"title":"Authentication","identifiers":["doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/AuthFlow","doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/SLAuthService"]}],"kind":"article","primaryContentSections":[{"kind":"content","content":[{"text":"Overview","type":"heading","anchor":"Overview","level":2},{"inlineContent":[{"text":"The ScribbleLab Auth Service is a secure, reliable and easy-to-use authentication service that allows users to gain access to the applicationâ€™s resources through a simple and straightforward process. The ScribbleLab Auth Service is built on top of Firebase, a powerful and scalable database service, ensuring that user authentication is done in a secure and robust manner.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"We offer our users three ways to authenticate:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Google Sign In ","type":"text"},{"inlineContent":[{"code":"(GID)","type":"codeVoice"}],"type":"strong"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"SignInWithApple "},{"inlineContent":[{"type":"codeVoice","code":"(SIWA)"}],"type":"strong"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"ScribbleLabApp Account "},{"type":"strong","inlineContent":[{"code":"(SLA)","type":"codeVoice"}]}]}]}]},{"inlineContent":[{"text":"All three ways are secure due to our secured database.","type":"text"}],"type":"paragraph"},{"anchor":"How-is-Firebase-connected-to-our-App","text":"How is Firebase connected to our App?","type":"heading","level":3},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"In order to use Firebase you need to import Firebase via SPM and import it in your AppFile as following:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["import SwiftUI","import FirebaseCore"]}]},{"content":[{"inlineContent":[{"text":"Then you need to add Firebase to your AppDelegate:","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["class AppDelegate: NSObject, UIApplicationDelegate {","    func application(_ application: UIApplication,","                didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {","        FirebaseApp.configure()","","        return true","    }","}"]},{"style":"note","type":"aside","name":"For the use for GID","content":[{"inlineContent":[{"text":"","type":"text"},{"type":"text","text":" "},{"text":"In order to use GID (= GoogleSignIn) you need to add GoogleSignIn to your Project via SPM. Then import it in your AppFile.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["import SwiftUI","import FirebaseCore","import GoogleSignIn"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Then add the following code to your AppDelegate in order to let GID run properly:"}],"type":"paragraph"},{"type":"codeListing","code":["\/\/ The method should call the handleURL method of GIDSignIn instance, which will properly handle the URL that SL recieves at the end of the auth process.","@available(iOS 9.0, *)","func application(_ application: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:]) -> Bool {","   return GIDSignIn.sharedInstance.handle(url)","}"],"syntax":"swift"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Firebase is now succesfully conected from your App site ðŸŽ‰","type":"text"}]}]}]},{"level":3,"text":"How does our Authentication work?","type":"heading","anchor":"How-does-our-Authentication-work"},{"inlineContent":[{"text":"While the App is launching it checks wether you have a valide UserSession (email, password, uuid). In order to do that we call our ","type":"text"},{"type":"reference","identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/ContentViewModel","isActive":true},{"type":"text","text":" that asks FirebaseAuth after a valide user session:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["private let service = SLAuthService.shared","private var canellables = Set<AnyCancellable>()","","@Published var userSession: FirebaseAuth.User?","@Published var currentUser: User?","","init() {","    setupSubscribers()","}","","func setupSubscribers() {","    service.$userSession.sink { [weak self] userSession in","        self?.userSession = userSession","    }","    .store(in: &canellables)","    ","    service.$currentUser.sink { [weak self] currentUser in","        self?.currentUser = currentUser","    }","    .store(in: &canellables)","}"]},{"type":"aside","content":[{"inlineContent":[{"type":"text","text":""}],"type":"paragraph"},{"type":"codeListing","code":["import SwiftUI","","struct ContentView: View {","   @StateObject var viewModel = ContentViewModel()","","   var body: some View {","       Group {","           if $viewModel.userSession == nil {","               SignUpView()","           } else if let currentUser = viewModel.currentUser {","             SLSideBarView()","          }","      }","   }","}"],"syntax":"swift"}],"name":"ContentView.swift","style":"note"},{"inlineContent":[{"type":"text","text":"While this is all happening our "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/ContentViewModel"},{"text":" also calls the ","type":"text"},{"identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/SLAuthService","type":"reference","isActive":true},{"text":" that tries to fetch the user:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["@MainActor","func loadUserData() async throws {","    self.userSession = Auth.auth().currentUser","    guard let currentUid = userSession?.uid else { return }","    self.currentUser = try await UserService.fetchUser(withUid: currentUid)","}"]},{"text":"Section header","anchor":"Section-header","type":"heading","level":3}]}],"hierarchy":{"paths":[["doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab"]]},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/scribblelab\/auth"]}],"abstract":[{"type":"text","text":"Scribble Labâ€™s Auth Services"}],"sections":[],"schemaVersion":{"major":0,"minor":3,"patch":0},"references":{"doc://com.nhstudio.ScribbleLab/documentation/ScribbleLab/AuthFlow":{"role":"article","url":"\/documentation\/scribblelab\/authflow","title":"AuthFlow","kind":"article","type":"topic","identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/AuthFlow","abstract":[{"type":"text","text":"ScribbleLabâ€™s Auth flow"}]},"doc://com.nhstudio.ScribbleLab/documentation/ScribbleLab":{"kind":"symbol","abstract":[{"text":"ScribbleLabâ€™s developer documentation","type":"text"}],"url":"\/documentation\/scribblelab","identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab","title":"ScribbleLab","type":"topic","role":"collection"},"doc://com.nhstudio.ScribbleLab/documentation/ScribbleLab/ContentViewModel":{"role":"symbol","url":"\/documentation\/scribblelab\/contentviewmodel","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"kind":"identifier","text":"ContentViewModel"}],"navigatorTitle":[{"text":"ContentViewModel","kind":"identifier"}],"title":"ContentViewModel","kind":"symbol","type":"topic","identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/ContentViewModel","abstract":[]},"doc://com.nhstudio.ScribbleLab/documentation/ScribbleLab/SLAuthService":{"role":"symbol","url":"\/documentation\/scribblelab\/slauthservice","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"kind":"identifier","text":"SLAuthService"}],"navigatorTitle":[{"text":"SLAuthService","kind":"identifier"}],"title":"SLAuthService","kind":"symbol","type":"topic","identifier":"doc:\/\/com.nhstudio.ScribbleLab\/documentation\/ScribbleLab\/SLAuthService","abstract":[{"text":"ScribbleLabâ€™s service responsible for managing user authentication and data operations.","type":"text"}]}}}